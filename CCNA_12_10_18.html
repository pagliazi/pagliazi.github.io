<html>
<head>
  <!-- META DATA -->
	<meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="personal Homepage of Zayl">
    <meta name="author" content="#">

	<title>CCNA - Router</title>
  
	<!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="css/bootstrap.min.css"  type="text/css">
	
	<!-- Owl Carousel Assets -->
    <link href="owl-carousel/owl.carousel.css" rel="stylesheet">
    <!-- <link href="owl-carousel/owl.theme.css" rel="stylesheet"> -->
	
	<!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css">
	
	<!-- Custom Fonts -->
    <link rel="stylesheet" href="font-awesome-4.4.0/css/font-awesome.min.css"  type="text/css">
	<link href='http://fonts.googleapis.com/css?family=Asap:400,700' rel='stylesheet' type='text/css'>
	
	<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="js/html5shiv.js"></script>
        <script src="js/respond.min.js"></script>
    <![endif]-->
	
</head>

<body class="sub-page">	
	<!-- /////////////////////////////////////////Navigation -->
    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand page-scroll" href="index.html">Metora</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a class="page-scroll" href="index.html">Home</a>
                    </li>
					<li>
                        <a class="page-scroll" href="archive.html">Blog</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="single.html">About</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="contact.html">Contact</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container-fluid -->
    </nav>
	<!-- Navigation -->
	
	<!-- Background Gradients-->
	<div  class="site-gradients">
		<div class="site-gradients-media">
			<figure>
				<img src="Another%20Yosemite%20short%20movie%20project%20%E2%80%93%20Modern_files/PcLGXNjMTdiFVKTrElCl__DSC2245.jpg" alt="PcLGXNjMTdiFVKTrElCl__DSC2245" srcset="https://themedemos.webmandesign.eu/modern/wp-content/uploads/sites/8/2014/11/PcLGXNjMTdiFVKTrElCl__DSC2245.jpg 1920w, https://themedemos.webmandesign.eu/modern/wp-content/uploads/sites/8/2014/11/PcLGXNjMTdiFVKTrElCl__DSC2245-420x280.jpg 420w, https://themedemos.webmandesign.eu/modern/wp-content/uploads/sites/8/2014/11/PcLGXNjMTdiFVKTrElCl__DSC2245-744x497.jpg 744w, https://themedemos.webmandesign.eu/modern/wp-content/uploads/sites/8/2014/11/PcLGXNjMTdiFVKTrElCl__DSC2245-1200x801.jpg 1200w" sizes="(max-width: 1617px) 100vw, 1617px" height="1080" width="1617">
			</figure>
		</div>
	</div>

	<header class="container">
		<div class="site-branding">
			<h1 class="site-title">
				<a href="index.html">
					<span>Metora</span>
				</a>
			</h1>
			<h2 class="site-description">Welcome !</h2>
		</div>
		<div class="social-links">
			<ul class="list-inline">
				<li><a href="#"><i class="fa fa-facebook"></i></a></li>
				<li><a href="#"><i class="fa fa-twitter"></i></a></li>
				<li><a href="#"><i class="fa fa-google-plus"></i></a></li>
				<li><a href="#"><i class="fa fa-vimeo"></i></a></li>
				<li><a href="#"><i class="fa fa-rss"></i></a></li>
			</ul>
		</div>
	</header>
	
	<!-- /////////////////////////////////////////Content -->
	<div id="page-content" class="single-page">
		<div class="container">
			<div class="row">
				<div id="main-content">
					<article>
						<img src="images/banner1.jpg" />
						<div class="art-content">
							<h1>CCNA学习记录</h1>
							<div class="info">By <a href="#">Zayl</a> on Octo 12, 2018</div>
							<div class="excerpt"><p>关于简单网络配置中遇到的问题</p></div>
							<p>（200-120）第四章路由器的配置基础知识</p>
							<img src="images/CCNA/topology4_4.jpg" />
							<p>网络拓扑如图</p>
							<h2>简单配置</h2>
							<p>路由器R1配置</p>
							<blockquote>
							<code><br>Router>en<br>
Router#conf t<br>
Enter configuration commands, one per line.  End with CNTL/Z.<br>
Router(config)#host R1<br>
R1(config)#int fa 0/0<br>
R1(config-if)#ip add 192.168.1.1 255.255.255.0<br>
R1(config-if)#no shut<br>

R1(config-if)#<br>
%LINK-5-CHANGED: Interface FastEthernet0/0, changed state to up<br><br>

%LINEPROTO-5-UPDOWN: Line protocol on Interface FastEthernet0/0, changed state to up<br><br>

R1(config)#int s0/0/1<br>
R1(config-if)#ip add 12.1.1.1 255.255.255.0<br>
R1(config-if)#no shut<br>
</code></blockquote>
							<p>路由器R2配置</p>
							<blockquote>
							<code>Router>en<br>
Router#conf t<br>
Enter configuration commands, one per line.  End with CNTL/Z.<br>
Router(config)#host R2<br>
R2(config)#int s0/0/0<br>
R2(config-if)#ip add 12.1.1.2 255.255.255.0<br>
R2(config-if)#no shut<br><br>

R2(config-if)#<br>
%LINK-5-CHANGED: Interface Serial0/0/0, changed state to up<br><br>

R2(config-if)#<br>
%LINEPROTO-5-UPDOWN: Line protocol on Interface Serial0/0/0, changed state to up<br><br>

R2(config-if)#int s0/0/1<br>
R2(config-if)#ip address 23.1.1.2 255.255.255.0<br>
R2(config-if)#no shut<br>
</code></blockquote>
							<p>路由器R3配置</p>
							<blockquote>
							<code>Router>en<br>
Router#conf t<br>
Enter configuration commands, one per line.  End with CNTL/Z.<br>
Router(config)#host R3<br>
R3(config)#int s0/0/0<br>
R3(config-if)#ip add 23.1.1.3 255.255.255.0<br>
R3(config-if)#no shut<br><br>

R3(config-if)#<br>
%LINK-5-CHANGED: Interface Serial0/0/0, changed state to up<br><br>

R3(config-if)#<br>
%LINEPROTO-5-UPDOWN: Line protocol on Interface Serial0/0/0, changed state to up<br><br>

R3(config-if)#exit<br>
R3(config)#int loopback ?<br>
  <0-2147483647>  Loopback interface number<br>
R3(config)#int loopback 0<br><br>

R3(config-if)#<br>
%LINK-5-CHANGED: Interface Loopback0, changed state to up<br><br>

%LINEPROTO-5-UPDOWN: Line protocol on Interface Loopback0, changed state to up<br><br>

R3(config-if)#ip address 3.3.3.3 255.255.255.0<br>
R3(config-if)#<br>
</code></blockquote>
							<p>Loopback为环回接口，环回接口是用于模拟路由条目的虚拟接口。稳定，除掉电或关闭，一直有效</p>
							<h2>测试连通性</h2>
							<p><span style="color:blue;font-size:20px">（1）测试网关</span></p>	
							<blockquote>
							<kbd>C:\>ping 192.168.1.1</kbd><br><samp><br>

Pinging 192.168.1.1 with 32 bytes of data:<br><br>

Reply from 192.168.1.1: bytes=32 time<1ms TTL=255<br>
Reply from 192.168.1.1: bytes=32 time=1ms TTL=255<br>
Reply from 192.168.1.1: bytes=32 time<1ms TTL=255<br>
Reply from 192.168.1.1: bytes=32 time<1ms TTL=255<br><br>

Ping statistics for 192.168.1.1:<br>
    Packets: Sent = 4, Received = 4, Lost = 0 (0% loss),<br>
Approximate round trip times in milli-seconds:<br>
    Minimum = 0ms, Maximum = 1ms, Average = 0ms</samp></blockquote>
							<p>若ping网关失败，则需要从低层向高层排查故障：
							<ul>
								<li>检查物理线路是否正常</li>
								<li>ping本地回环地址127.0.0.1,看TCP/IP栈是否正常</li>
								<li>ping本机IP地址检查网卡驱动</li>
								<li>检查子网掩码是否正常</li>
								<li>检查防火墙</li>
							</ul>	
							</p>
							<p><span style="color:blue;font-size:20px">（2）测试不同子网的IP地址</span></p>	
							<blockquote>
							<kbd>
							C:\>ping 12.1.1.1</kbd><br><samp><br>

Pinging 12.1.1.1 with 32 bytes of data:<br><br>

Request timed out.<br>
Request timed out.<br>
Request timed out.<br>
Request timed out.<br>
<br>
Ping statistics for 12.1.1.1:<br>
&nbsp    Packets: Sent = 4, Received = 0, Lost = 4 (100% loss),<br>
							</samp>
							</blockquote>
							<p>ping路由器R1的S0/0/1接口地址12.1.1.1显示超时，在路由器R1上进行调试，输出如下</p>
							<blockquote>
							<kbd>R1>en<br>
R1#debug ip icmp</kbd><br><samp>
ICMP packet debugging is on<br>
R1#<br>
ICMP: echo reply sent, src 192.168.1.1, dst 192.168.1.2<br><br>

ICMP: echo reply sent, src 192.168.1.1, dst 192.168.1.2<br><br>

ICMP: echo reply sent, src 192.168.1.1, dst 192.168.1.2<br><br>

ICMP: echo reply sent, src 192.168.1.1, dst 192.168.1.2<br>						
							</samp>
							</blockquote>
							<p>在PC上继续ping路由器R1的接口地址，ping Fa0/0端口时R1同步显示，但ping S0/0/1接口时无反应</p>
							<p>猜想原因路由器R1未收到包</p>
							<p><em><span style="color:blue">实际原因未在PC上配置网关192.168.1.1</span></em></p>
							<p></p>
							<p>继续ping别的IP地址，R2的S0/0/0接口12.1.1.2不通，在R2上debug:</p>
							<blockquote><code>R2#debug ip icmp</code><br><samp>
ICMP packet debugging is on<br>
R2#<br>
ICMP: echo reply sent, src 12.1.1.2, dst 192.168.1.2<br><br>

ICMP: echo reply sent, src 12.1.1.2, dst 192.168.1.2<br><br>

ICMP: echo reply sent, src 12.1.1.2, dst 192.168.1.2<br><br>

ICMP: echo reply sent, src 12.1.1.2, dst 192.168.1.2<br></samp></blockquote>
							<p>PC端显示超时而Router端显示已回应，则说明R2已收到echo request包，并发送了echo reply包</p>
							<p>查看R2的路由表：</p>
							<blockquote>
							<code>R2#show ip route</code><br><samp>
Codes: C - connected, S - static, I - IGRP, R - RIP, M - mobile, B - BGP<br>
&nbsp&nbsp  &nbsp  &nbsp     D - EIGRP, EX - EIGRP external, O - OSPF, IA - OSPF inter area<br>
&#8195&#8195&#8195&#8195&#8195&#8195	N1 - OSPF NSSA external type 1, N2 - OSPF NSSA external type 2<br>
&#8194&#8194&#8194&#8194&#8194&#8195      E1 - OSPF external type 1, E2 - OSPF external type 2, E - EGP<br>
&nbsp&nbsp 	&#8195	&#8195      i - IS-IS, L1 - IS-IS level-1, L2 - IS-IS level-2, ia - IS-IS inter area<br>
&nbsp&#8195 &#8195 &#8195      * - candidate default, U - per-user static route, o - ODR<br>
&nbsp&nbsp&nbsp&nbsp&#8195&#8195      P - periodic downloaded static route<br><br>

Gateway of last resort is not set<br><br>

&nbsp&nbsp  &nbsp  &nbsp       12.0.0.0/24 is subnetted, 1 subnets<br>
C&nbsp&nbsp&nbsp  &nbsp  &nbsp         12.1.1.0 is directly connected, Serial0/0/0<br>
&nbsp&nbsp  &nbsp  &nbsp       23.0.0.0/24 is subnetted, 1 subnets<br>
C&nbsp&nbsp&nbsp  &nbsp  &nbsp         23.1.1.0 is directly connected, Serial0/0/1<br></samp>
							</blockquote>
							<p>可见路由表没有更新，表中没有指明去往192.168.1.2的路由，添加后ping通</p>
							<blockquote>
							<code>R2(config)#ip route 192.168.1.0 255.255.255.0 12.1.1.1</code></blockquote>
							<p></p>
							<p>添加其他路由：</p>
							<blockquote>
							<code>R1(config)#ip route 0.0.0.0 0.0.0.0 12.1.1.2</code></blockquote>
							<blockquote>
							<code>R2(config)#ip route 3.3.3.3 255.255.255.0 23.1.1.3</code></blockquote>
							<blockquote>
							<code>R3(config)#ip route 0.0.0.0 0.0.0.0 23.1.1.2</code></blockquote>
							<h2></h2>
							<p>其中R2未添加路由3.3.3.0/24前会出现:</p>
							<blockquote>
							<samp>Pinging 3.3.3.3 with 32 bytes of data:<br><br>

Reply from 12.1.1.2: Destination host unreachable.<br>
Reply from 12.1.1.2: Destination host unreachable.<br>
Reply from 12.1.1.2: Destination host unreachable.<br>
Request timed out.<br><br>

Ping statistics for 3.3.3.3:<br>
&nbsp    Packets: Sent = 4, Received = 0, Lost = 4 (100% loss),</samp></blockquote>
							<p><em>request time out 是指icmp包发出后，长时间没有回应，所以会产生request time out。一般是ping了一台网络中不存在的主机。 
destination is unreachable 或 destination port unreachable 一般是收到了目标主机或中间路由器回应的端口或目标主机不可达icmp包。 </em></p>
							<h2>进一步测试连通性</h2>
							<p>在R1上ping 3.3.3.3：</p>
							<blockquote>
							<code>R1#ping 3.3.3.3</code><br><br><samp>

Type escape sequence to abort.<br>
Sending 5, 100-byte ICMP Echos to 3.3.3.3, timeout is 2 seconds:<br>
!!!!!<br>
Success rate is 100 percent (5/5), round-trip min/avg/max = 2/6/19 ms</samp>
							
							</blockquote>
							<p>关闭R3loopback端口：</p>
							<blockquote>
							<code>
R3(config)#int lo0<br>
R3(config-if)#shut</code><br><br>
<code>R1#debug ip icmp<br>
ICMP packet debugging is on<br>
R1#ping 3.3.3.3</code><br><br>


<samp>
Type escape sequence to abort.<br>
Sending 5, 100-byte ICMP Echos to 3.3.3.3, timeout is 2 seconds:<br><br>

ICMP: time exceeded (time to live) rcvd from 12.1.1.2<br>
.<br>
ICMP: time exceeded (time to live) rcvd from 12.1.1.2<br>
.<br>
ICMP: time exceeded (time to live) rcvd from 12.1.1.2<br>
.<br>
ICMP: time exceeded (time to live) rcvd from 12.1.1.2<br>
.<br>
ICMP: time exceeded (time to live) rcvd from 12.1.1.2<br>
.<br>
Success rate is 0 percent (0/5)<br>
</samp></blockquote><p>超时，产生环路<br></p>
							<p>打开R3loopback端口,关闭R2 S0/0/1接口,在R1 ping 3.3.3.3：</p>
							<blockquote><code>
							R1#ping 3.3.3.3</code><br><br>
							<samp>
Type escape sequence to abort.<br>
Sending 5, 100-byte ICMP Echos to 3.3.3.3, timeout is 2 seconds:<br>
U<br>
ICMP: dst (12.1.1.1)  host unreachable rcv from 12.1.1.2<br>
.U<br>
ICMP: dst (12.1.1.1)  host unreachable rcv from 12.1.1.2<br>
.U<br>
Success rate is 0 percent (0/5)<br><br>

R1#<br>
ICMP: dst (12.1.1.1)  host unreachable rcv from 12.1.1.2</samp><br>
</blockquote>
							<p>查看R2路由表，丢失S0/0/1的直连路由和去往3.3.3.3的静态路由</p>
							<blockquote><samp>
         12.0.0.0/24 is subnetted, 1 subnets<br>
C           12.1.1.0 is directly connected, Serial0/0/0<br>
S        192.168.1.0/24 [1/0] via 12.1.1.1<br></samp>
</blockquote>
							<h2>高级ping</h2>
							<p>在R1上ping</p>

							<h2>文件管理</h2>
							<br>
							<p>查看运行配置文件</p>
							<blockquote><p><code>R1#show running-config</code></blockquote>  <br>
							<p>查看保存的配置文件</p>
							<blockquote><code>R1#show startup-config</code></blockquote>
							<p>保存运行配置文件</p>
							<blockquote><code>R1#copy running-config startup-config</code></blockquote>&nbsp<span style="fontsize:10px"><i>一般简写成 copy run start</i></span><br>
							或者<br><blockquote><code>R1#write</code></blockquote>&nbsp<span style="fontsize:10px"><i>用运行配置文件覆盖启动配置文件</i></span>
							<p>Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, 
							 sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum.</p>
						
							<p>Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, 
							sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.</p>
							<div class="note">
							  <ol>
								<li>Lorem ipsum</li>
								<li>Sit amet vultatup nonumy</li>
								<li>Duista sed diam</li>
							  </ol>
							  <div class="clear"></div>
							</div>
							<p>Duis autem vel eum iriure dolor in hendrerit in vulputate velit esse molestie consequat, vel illum dolore eu feugiat nulla facilisis at 
							 vero eros et accumsan et iusto odio dignissim qui blandit praesent luptatum zzril delenit augue duis dolore te feugait nulla facilisi. 
							 Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</p>
							<p>Consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores.</p>
						</div>
					</article>
					<div class="widget wid-related">
						<div class="heading"><h4>Related Post</h4></div>
						<div class="content">
							<div class="row">
								<div class="col-md-4">
									<div class="wrap-col">
										<a href="#"><img src="images/7.jpg" /></a>
										<h4><a href="#">Vero eros et accumsan et iusto odio </a></h4>
									</div>
								</div>
								<div class="col-md-4">
									<div class="wrap-col">
										<a href="#"><img src="images/8.jpg" /></a>
										<h4><a href="#">Vero eros et accumsan et iusto odio </a></h4>
									</div>
								</div>
								<div class="col-md-4">
									<div class="wrap-col">
										<a href="#"><img src="images/6.jpg" /></a>
										<h4><a href="#">Vero eros et accumsan et iusto odio </a></h4>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		
	</div>

	<!-- FOOTER -->
	<footer>
		<div class="wrap-footer">
			<div class="container">
				<div class="row"> 
					<div class="col-footer col-md-3">
						<h2 class="footer-title">About Me</h2>
						<div class="textwidget">My info<br> <br> 
						lalalala</div>
					</div> 
					<div class="col-footer col-md-3 widget_recent_entries">
						<h2 class="footer-title">Recent Posts</h2>
						<ul>
							<li><a href="#">MOST VISITED COUNTRIES</a></li>
							<li><a href="#">5 PLACES THAT MAKE A GREAT HOLIDAY</a></li>
							<li><a href="#">PEBBLE TIME STEEL IS ON TRACK TO SHIP IN JULY</a></li>
							<li><a href="#">STARTUP COMPANY&#8217;S CO-FOUNDER TALKS ON HIS NEW PRODUCT</a></li>
						</ul>
					</div>
					<div class="col-footer col-md-3">
						<h2 class="footer-title">NEWS LETTER</h2>
						If you want to receive our latest news send directly to your email, please leave your email address bellow. Subscription is free and you can cancel anytime.
						<form action="#" method="post">
							<input type="text" name="your-name" value="" size="40" placeholder="Your Email" />
							<input type="submit" value="SUBSCRIBE" class="btn btn-skin" />
						</form>
					</div>
					<div class="col-footer col-md-3">
						<h2 class="footer-title">Tags</h2>
						<div class="footer-tags">
							<a href="#">animals</a>
							<a href="#">cooking</a>
							<a href="#">countries</a>
							<a href="#">city</a>
							<a href="#">children</a>
							<a href="#">home</a>
							<a href="#">likes</a>
							<a href="#">photo</a>
							<a href="#">link</a>
							<a href="#">law</a>
							<a href="#">shopping</a>
							<a href="#">skate</a>
							<a href="#">scholl</a>
							<a href="#">video</a>
							<a href="#">travel</a>
							<a href="#">images</a>
							<a href="#">love</a>
							<a href="#">lists</a>
							<a href="#">makeup</a>
							<a href="#">media</a>
							<a href="#">password</a>
							<a href="#">pagination</a>
							<a href="#">wildlife</a>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="bottom-footer">
			<div class="container">
				<div class="row">
					<div class="col-md-4">
						<p>Copyright © 2017 Zayl All Rights Reserved </p>
					</div>
					<div class="col-md-4">
						<ul class="list-inline social-buttons">
							<li><a href="#"><i class="fa fa-twitter"></i></a>
							</li>
							<li><a href="#"><i class="fa fa-facebook"></i></a>
							</li>
							<li><a href="#"><i class="fa fa-linkedin"></i></a>
							</li>
							<li><a href="#"><i class="fa fa-pinterest"></i></a>
							</li>
						</ul>
					</div>
					<div class="col-md-4">
						<ul class="list-inline quicklinks">
							<li><a href="#">Privacy Policy</a>
							</li>
							<li><a href="#">Terms of Use</a>
							</li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</footer>
  
	<!-- jQuery -->
	<script type="text/javascript" src="js/jquery-2.1.1.js"></script>
	<script type="text/javascript" src="js/bootstrap.min.js"></script>
	
	<!-- Custom Theme JavaScript -->
	<script src="js/agency.js"></script>

	<!-- Plugin JavaScript -->
	<script src="js/jquery.easing.min.js"></script>
	<script src="js/classie.js"></script>
	<script src="js/cbpAnimatedHeader.js"></script>
	
</body>
</html>